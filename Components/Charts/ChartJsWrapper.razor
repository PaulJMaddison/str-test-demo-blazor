@inject IJSRuntime JSRuntime

<div class="chart-js-wrapper" style="position:relative;height:100%;width:100%;">
    <canvas id="@ChartId"></canvas>
</div>

@code {
    [Parameter, EditorRequired] public string ChartId { get; set; } = string.Empty;
    [Parameter, EditorRequired] public string ChartType { get; set; } = string.Empty;
    [Parameter, EditorRequired] public string[] Labels { get; set; } = Array.Empty<string>();
    [Parameter, EditorRequired] public double[] Data { get; set; } = Array.Empty<double>();
    [Parameter, EditorRequired] public string[] BackgroundColors { get; set; } = Array.Empty<string>();

    private string? _lastSignature;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        var signature = $"{ChartId}|{ChartType}|{string.Join(',', Labels)}|{string.Join(',', Data)}|{string.Join(',', BackgroundColors)}";
        if (firstRender || !string.Equals(_lastSignature, signature, StringComparison.Ordinal))
        {
            _lastSignature = signature;
            await JSRuntime.InvokeVoidAsync(
                "renderChart",
                ChartId,
                ChartType,
                Labels,
                Data,
                BackgroundColors);
        }
    }
}
